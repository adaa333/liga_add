package util;

import java.util.List;

import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.Logger;

import entities.Equipo;
import jakarta.persistence.EntityExistsException;
import jakarta.persistence.PersistenceException;
import jakarta.persistence.RollbackException;
import jakarta.persistence.TransactionRequiredException;

public abstract class CRUD<T> implements DAO<T>{
	private static Logger logger=LogManager.getLogger(Equipo.class.getName());

	public void insert(T entity) {
		try {
			Manager.persist(entity);
		} catch (EntityExistsException entityExists) {
			System.err.println("Entity: "+entity.getClass()+" already exists");
			logger.error("Entity: "+entity.getClass()+" already exists - "+entityExists.getMessage()+"\nCaused by: "+entityExists.getCause());
		}catch (TransactionRequiredException transactionRequired) {
			System.err.println(transactionRequired.getMessage());
			logger.error("Error con la transacci칩n al insertar: "+entity.getClass()+" - "+transactionRequired.getMessage());
		}catch (RollbackException rollback) {
			System.err.println("Error: ha fallado un commit al intentar a침adir: "+entity.getClass());
			logger.error("Ha fallado un commit al intentar a침adir: "+entity.getClass()+" - "+rollback.getMessage());
		}catch(PersistenceException persistenceFailed) {
			System.err.println("Flush failed while inserting entity: "+entity.getClass());
			logger.error("Flush failed while inserting entity: "+entity.getClass()+"\nCaused by: "+persistenceFailed.getCause());
		}

		

		logger.info("la entidad "+entity.getClass()+" se ha insertado en orm_competicion");
		
	}

	public void delete(T entity) {
		try {
			Manager.remove(entity);
			logger.warn("la entidad "+entity.getClass()+" se ha eliminado de orm_competicion");
			
		}catch (TransactionRequiredException transactionRequired) {
			System.err.println(transactionRequired.getMessage());
			logger.error("Error con la transacci칩n al eliminar: "+entity.getClass()+" - "+transactionRequired.getMessage());
		}catch (RollbackException rollback) {
			System.err.println("Error: ha fallado un commit al intentar eliminar: "+entity.getClass()+" de la Tabla SPORTSMEN.");
			logger.error("Ha fallado un commit al intentar eliminar: "+entity.getClass()+" de la Tabla SPORTSMEN - "+rollback.getMessage());
		}catch(PersistenceException persistenceFailed) {
			System.err.println("Flush failed while deleting entity: Deportista-"+entity.getClass());
			logger.error("Flush failed while deleting entity: Deportista-"+entity.getClass()+"\nCaused by: "+persistenceFailed.getCause());
		}
	}

	public List<T> selectAll() {
		// TODO Auto-generated method stub
		return null;
	}

	public T select(int id) {
		// TODO Auto-generated method stub
		return null;
	}

	public void update(T entity) {
		// TODO Auto-generated method stub
		
	}

}
